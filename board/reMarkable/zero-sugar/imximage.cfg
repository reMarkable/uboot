/*
 * Copyright (C) 2015 Freescale Semiconductor, Inc.
 * Copyright 2017 NXP
 *
 * SPDX-License-Identifier:	GPL-2.0+
 *
 * Refer doc/README.imximage for more details about how-to configure
 * and create imximage boot image
 *
 * The syntax is taken as close as possible with the kwbimage
 */

#define __ASSEMBLY__
#include <config.h>

/* image version */

IMAGE_VERSION 2

/*
 * Boot Device : sd
 */

BOOT_FROM	sd

#ifdef CONFIG_USE_IMXIMG_PLUGIN
/*PLUGIN    plugin-binary-file    IRAM_FREE_START_ADDR*/
PLUGIN	board/reMarkable/zero-sugar/plugin.bin 0x00910000
#else
/*
 * Secure boot support
 */
#ifdef CONFIG_SECURE_BOOT
CSF CONFIG_CSF_SIZE
#endif

/*
 * Device Configuration Data (DCD)
 *
 * Each entry must have the format:
 * Addr-type           Address        Value
 *
 * where:
 *	Addr-type register length (1,2 or 4 bytes)
 *	Address	  absolute address of the register
 *	value	  value to be stored in the register
 */

#ifdef CONFIG_IMX_OPTEE
DATA 4 0x30340024 0x1
CHECK_BITS_SET 4 0x30340024 0x1
#endif
DATA 4 0x30340004 0x4F400005
/* Clear then set bit30 to ensure exit from DDR retention */
DATA 4 0x30360388 0x40000000
DATA 4 0x30360384 0x40000000

/*
DATA 4 0x30391000 0x00000002
DATA 4 0x307a0000 0x01040001
DATA 4 0x307a01a0 0x80400003
DATA 4 0x307a01a4 0x00100020
DATA 4 0x307a01a8 0x80100004
DATA 4 0x307a0064 0x00400046
DATA 4 0x307a0490 0x00000001
DATA 4 0x307a00d0 0x00020083
DATA 4 0x307a00d4 0x00690000
DATA 4 0x307a00dc 0x09300004
DATA 4 0x307a00e0 0x04080000
DATA 4 0x307a00e4 0x00100004
DATA 4 0x307a00f4 0x0000033f
DATA 4 0x307a0100 0x09081109
DATA 4 0x307a0104 0x0007020d
DATA 4 0x307a0108 0x03040407
DATA 4 0x307a010c 0x00002006
DATA 4 0x307a0110 0x04020205
DATA 4 0x307a0114 0x03030202
DATA 4 0x307a0120 0x00000803
DATA 4 0x307a0180 0x00800020
DATA 4 0x307a0184 0x02000100
DATA 4 0x307a0190 0x02098204
DATA 4 0x307a0194 0x00030303
DATA 4 0x307a0200 0x00000016
DATA 4 0x307a0204 0x00080808
DATA 4 0x307a0210 0x00000f0f
DATA 4 0x307a0214 0x07070707
DATA 4 0x307a0218 0x0f070707
DATA 4 0x307a0240 0x06000604
DATA 4 0x307a0244 0x00000001
DATA 4 0x30391000 0x00000000
DATA 4 0x30790000 0x17420f40
DATA 4 0x30790004 0x10210100
DATA 4 0x30790010 0x00060807
DATA 4 0x307900b0 0x1010007e
DATA 4 0x3079009c 0x00000b24
*/


/*
#=============================================================================
# DDR Controller Registers
#=============================================================================
# Memory type:
# Manufacturer:
# Device Part Number:
# Clock Freq.: 
# Density per CS in Gb: 
# Chip Selects used:
# Number of Banks:
# Row address:    
# Column address: 
# Data bus width:
# ROW-BANK interleave:
#=============================================================================
*/

DATA 4 0x30391000 0x00000002
DATA 4 0x307A0000 0x01040008
DATA 4 0x307A0064 0x00200038
DATA 4 0x307a0490 0x00000001
/* DATA 4 0x307A00D4 0x00010000 */
DATA 4 0x307A00D0 0x00350001
DATA 4 0x307A00D8 0x00001105
DATA 4 0x307A00DC 0x00C3000A
DATA 4 0x307A00E0 0x00020000
DATA 4 0x307A00E4 0x00110006
DATA 4 0x307A00F4 0x0000033F
DATA 4 0x307A0100 0x0A0E110B
DATA 4 0x307A0104 0x00020211
DATA 4 0x307A0108 0x03060708
DATA 4 0x307A010C 0x00A0500C
DATA 4 0x307A0110 0x05020307
DATA 4 0x307A0114 0x02020404
DATA 4 0x307A0118 0x02020003
DATA 4 0x307A011C 0x00000202
DATA 4 0x307A0120 0x00000202
DATA 4 0x307A0180 0x20600018
DATA 4 0x307A0184 0x00E00100
DATA 4 0x307A0190 0x02098205
DATA 4 0x307A0194 0x00060303
DATA 4 0x307A01A0 0x80400003
DATA 4 0x307A01A4 0x00100020
DATA 4 0x307A01A8 0x80100004
DATA 4 0x307A0200 0x0000001F
DATA 4 0x307A0204 0x00080808
DATA 4 0x307A020C 0x00000000
DATA 4 0x307A0210 0x00000F0F
DATA 4 0x307A0214 0x07070707
DATA 4 0x307A0218 0x0F070707
DATA 4 0x307A0240 0x06000600
DATA 4 0x307A0244 0x00000000

/*
#=============================================================================
# PHY Control Registers
#=============================================================================
*/

DATA 4 0x30391000 0x00000000
DATA 4 0x30790000 0x17421E40
DATA 4 0x30790004 0x10210100
DATA 4 0x30790008 0x00010000
DATA 4 0x30790010 0x0007080C
DATA 4 0x307900B0 0x1010007E
DATA 4 0x3079001C 0x01010000
DATA 4 0x3079009C 0x00000D6E
 
/*DATA 4 0x30790078 0x00000001 */

/* DATA 4 0x3079006C 0x00000000 */

/* Lars flavour of Steinars fix */
DATA 4 0x3079006C 0x00070206


/* DATA 4 0x30790078 0x00000000 */
 
DATA 4 0x30790030 0x06060606
DATA 4 0x30790020 0x0A0A0A0A
DATA 4 0x30790050 0x01000008
DATA 4 0x30790050 0x00000008
DATA 4 0x30790018 0x0000000F
DATA 4 0x307900C0 0x0E487304
DATA 4 0x307900C0 0x0E4C7304
DATA 4 0x307900C0 0x0E4C7306

DATA 4 0x307900C0 0x0E487304


/* Init */
DATA 4 0x30384130 0x00000000
DATA 4 0x30340020 0x00000178
DATA 4 0x30384130 0x00000002
DATA 4 0x30790018 0x0000000f

CHECK_BITS_SET 4 0x307a0004 0x1

#endif
